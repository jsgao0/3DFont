<!DOCTYPE html>
<html>
  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">

    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/github-dark.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/print.css" media="print">

    <title>3dfont-feeder by jsgao0</title>
    
    <script type="text/javascript" src="https://code.jquery.com/jquery-2.1.4.min.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r71/three.js"></script>
    <script type="text/javascript" src="http://kovacsv.github.io/JSModeler/build/jsmodeler.js"></script>
    <script type="text/javascript" src="http://kovacsv.github.io/JSModeler/build/jsmodeler.viewer.js"></script>
    <script type="text/javascript">

    var viewer = null;
  
    function OpenSVG (index)
    {
      if (viewer == null) {
        alert ('Your browser does not support WebGL.');
        return;
      }
    
      var floating = document.getElementById ('floating');
      floating.style.display = 'block';
      Resize ();

      viewer.RemoveMeshes ();
      
      var svgObjects = document.getElementsByTagName ('svg');
      if (svgObjects.length <= index) {
        return;
      }

      var modelAndMaterials = JSM.SvgToModel (svgObjects[index], 8, 5, null);
      var meshes = JSM.ConvertModelToThreeMeshes (modelAndMaterials[0], modelAndMaterials[1]);
      viewer.AddMeshes (meshes);

      viewer.FitInWindow ();
      viewer.Draw ();
    }

    function Load ()
    {
      var viewerSettings = {
        cameraEyePosition : [-3, -2, 1.0],
        cameraCenterPosition : [0.0, 0.0, 0.0],
        cameraUpVector : [0.0, 0.0, 1.0],
        nearClippingPlane : 1.0,
        farClippingPlane : 100000.0
      };

      viewer = new JSM.ThreeViewer ();
      if (!viewer.Start (document.getElementById ('svgcanvas'), viewerSettings)) {
        viewer = null;
      } else {
        viewer.navigation.EnablePan (false);
      }
    }
    
    function DocumentClick (clickEvent)
    {
      var floating = document.getElementById ('floating');
      var isInFloating = false;
      
      var target = clickEvent.target;
      while (target !== null) {
        if (target === floating) {
          isInFloating = true;
          break;
        }
        target = target.parentElement;
      }
      
      if (!isInFloating) {
        if (floating.style.display !== 'none') {
          floating.style.display = 'none';
        }
      }
    }

    function DocumentKeyDown (keyEvent)
    {
      var floating = document.getElementById ('floating');
      if (keyEvent.keyCode == 27) {
        floating.style.display = 'none';
      }
    }
    
    function Resize ()
    {
      var floating = document.getElementById ('floating');
      var canvas = document.getElementById ('svgcanvas');
      if (floating.style.display === 'block') {
        var floatingMargin = 80;
        var left = window.pageXOffset + floatingMargin;
        var top = window.pageYOffset + floatingMargin;
        floating.style.left = left + 'px';
        floating.style.top = top + 'px';
        floating.style.width = (window.innerWidth - 2.0 * floatingMargin) + 'px';
        floating.style.height = (window.innerHeight - 2.0 * floatingMargin) + 'px';
        canvas.width = window.innerWidth - 2.0 * floatingMargin;
        canvas.height = window.innerHeight - 2.0 * floatingMargin;
        if (viewer != null) {
          viewer.Resize ();
        }
      }
    }

    function getSVGPath(char, callback) {
      $.ajax({
        url: "https://jsgao0-3d-font-feeder.herokuapp.com/getGlyfPathByChar/msjh/" + char,
        method: "GET",
        dataType: "jsonp"
      }).done(function(data) {
        callback(data);
      })
    }

    window.onload = function ()
    {
      window.onresize = Resize;
      window.onscroll = Resize;
      document.onclick = DocumentClick;
      document.onkeydown = DocumentKeyDown;

      Resize ();
      Load ();
    }
  
    </script>
  </head>

  <body>

    <header>
      <div class="container">
        <h1>3dfont-feeder</h1>
        <h2>Abstract svg path from TTF and response JSON.</h2>

        <section id="downloads">
          <a href="https://github.com/jsgao0/3DFont-Feeder/zipball/master" class="btn">Download as .zip</a>
          <a href="https://github.com/jsgao0/3DFont-Feeder/tarball/master" class="btn">Download as .tar.gz</a>
          <a href="https://github.com/jsgao0/3DFont-Feeder" class="btn btn-github"><span class="icon"></span>View on GitHub</a>
        </section>
      </div>
    </header>

    <div class="container">
      <section id="main_content">
        <canvas></canvas>
      </section>
    </div>

    
  </body>
</html>
